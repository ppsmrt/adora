<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Admin - Manage Clients</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getDatabase, ref, set, push, remove, onValue } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";
    import { getStorage, ref as sRef, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-storage.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCrGIB_YK33p_2EPTpU-klZ_3xQ5TOPm4c",
      authDomain: "adora-ad.firebaseapp.com",
      databaseURL: "https://adora-ad-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "adora-ad",
      storageBucket: "adora-ad.firebasestorage.app",
      messagingSenderId: "550034277527",
      appId: "1:550034277527:web:966b16ce942a161e8955d2",
      measurementId: "G-QW5Y41EKLR"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const storage = getStorage(app);

    // Add Tenant
    document.getElementById("addForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const block = document.getElementById("block").value;
      const floor = document.getElementById("floor").value;
      const name = document.getElementById("name").value;
      const file = document.getElementById("logo").files[0];

      if (!block || !floor || !name || !file) return alert("Fill all fields");

      // Upload Logo
      const logoRef = sRef(storage, `logos/${block}/${floor}/${file.name}`);
      await uploadBytes(logoRef, file);
      const logoUrl = await getDownloadURL(logoRef);

      // Save to DB
      const tenantRef = push(ref(db, `blocks/${block}/floors/${floor}/tenants`));
      await set(tenantRef, { name, logoUrl });

      alert("Tenant Added!");
      e.target.reset();
    });
  </script>
</head>
<body class="bg-gray-900 text-white p-6">
  <h1 class="text-2xl font-bold mb-4">Admin - Manage Clients</h1>

  <form id="addForm" class="space-y-4">
    <select id="block" class="p-2 bg-gray-800 rounded w-full">
      <option value="">Select Block</option>
      <option value="A">Block A</option>
      <option value="B">Block B</option>
      <option value="C">Block C</option>
    </select>

    <input id="floor" type="number" placeholder="Floor Number" class="p-2 bg-gray-800 rounded w-full"/>

    <input id="name" type="text" placeholder="Tenant Name" class="p-2 bg-gray-800 rounded w-full"/>

    <input id="logo" type="file" accept="image/*" class="p-2 bg-gray-800 rounded w-full"/>

    <button type="submit" class="bg-green-600 px-4 py-2 rounded">Add Tenant</button>
  </form>
</body>
</html>